# 连续订单处理功能使用指南

## 功能概述

现在系统支持连续订单输入模式，您可以在不重启程序的情况下连续处理多个菜品订单。

## 主要改进

### 1. 交互式启动
- **之前**: `python main.py "西红柿炒蛋"` (单次处理后退出)
- **现在**: `python main.py` (启动交互式模式)

### 2. 连续处理能力
- 系统只初始化一次（包括toio设备连接）
- 每个新订单会自动重置任务队列
- 处理完一个订单后可立即输入下一个

### 3. 智能状态管理
- 全局烹饪系统实例复用
- 自动任务队列重置
- 确保订单间状态隔离

## 使用方法

### 启动系统
```bash
python main.py
```

### 支持的命令

#### 菜品订单
直接输入菜品名称：
```
西红柿炒蛋
宫保鸡丁
炝炒西兰花
麻婆豆腐
```

#### 系统命令
- `help` 或 `h`: 显示帮助信息
- `quit` 或 `exit` 或 `q`: 退出程序
- `clear`: 清屏并显示欢迎信息

## 使用示例

```
🍳 CamelAI 动态多智能体 Overcooked 系统
🔄 连续订单处理模式
============================================================

📝 请输入菜品名称 (或输入 'help' 查看帮助): 西红柿炒蛋

📋 正在处理订单: 西红柿炒蛋
--------------------------------------------------
🤖 使用多智能体协作系统...
🔄 任务队列已重置，准备处理新订单
...
✅ 订单处理完成!

📈 已处理订单数量: 1

📝 请输入菜品名称 (或输入 'help' 查看帮助): 宫保鸡丁

📋 正在处理订单: 宫保鸡丁
--------------------------------------------------
🤖 使用多智能体协作系统...
🔄 任务队列已重置，准备处理新订单
...
✅ 订单处理完成!

📈 已处理订单数量: 2

📝 请输入菜品名称 (或输入 'help' 查看帮助): quit
👋 感谢使用CamelAI多智能体烹饪系统，再见!

📊 会话统计: 总共处理了 2 个订单
👋 程序结束
```

## 技术细节

### 系统架构优化
1. **全局实例管理**: 使用 `_global_cooking_system` 避免重复初始化
2. **状态重置机制**: 每个新订单前调用 `kitchen_state.reset_task_queue()`
3. **错误恢复能力**: 单个订单失败不影响后续处理

### 资源管理
- toio设备只连接一次
- CamelAI Workforce复用
- 智能资源清理

### 用户体验
- 友好的交互界面
- 实时进度反馈
- 订单统计信息
- 优雅的错误处理

## 注意事项

1. **首次启动**: 系统会在处理第一个订单时初始化，需要连接toio设备
2. **设备要求**: 确保toio cubes已开机且在连接范围内
3. **中断处理**: 使用 Ctrl+C 可以安全退出程序
4. **文件输出**: 每个订单的结果会保存为带时间戳的JSON文件

## 测试

运行测试脚本验证功能：
```bash
python test_mock_continuous.py
```

这个改进让系统更加用户友好，支持真正的连续订单处理能力！